define(["jquery","core/ajax","core/url"],function(a,b,c){var d=function(){e(a(this).data("groupid"));var c=b.call([{methodname:"block_groups_create_output",args:{groups:{id:a(this).data("groupid"),courseid:a(this).data("courseid")}}}]);return c[0].done(function(b){var c=b.newelement;a(".group-"+b.id).replaceWith(c),1===b.visibility&&a(".membergroup-"+b.id).removeClass("hiddengroups"),0===b.visibility&&a(".membergroup-"+b.id).addClass("hiddengroups"),a(".group-"+b.id+" .block_groups_toggle").on("click",d),f(b.id)}),!1},e=function(b){var d=c.imageUrl("i/loading_small","moodle"),e=document.createElement("img");return e.className="spinner"+b,e.src=d,e.hidden=!1,a(".imggroup-"+b).before(e),!1},f=function(b){a(".spinner"+b).length>0&&a(".imggroup-"+b+"img:first-child").remove()};return{initialise:function(){a(".block_groups_toggle").on("click",d)}}});